"use strict";(globalThis.webpackChunkairpath_docs=globalThis.webpackChunkairpath_docs||[]).push([[3292],{554:(e,i,n)=>{n.d(i,{A:()=>r});const r=n.p+"assets/images/grid-topdown-view-b36cad739840531be3e8466a853a0a63.png"},1906:(e,i,n)=>{n.d(i,{A:()=>r});const r=n.p+"assets/images/cell-height-sampling-3552101a1049fd764f9b023b5a15a942.png"},5743:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>o,contentTitle:()=>t,default:()=>h,frontMatter:()=>d,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"core-concepts/grid-system","title":"Grid System","description":"AirPath uses a 2D grid projected over your terrain to represent navigable space. This page explains how the grid works and how to configure it.","source":"@site/docs/core-concepts/grid-system.md","sourceDirName":"core-concepts","slug":"/core-concepts/grid-system","permalink":"/airpath-docs/docs/core-concepts/grid-system","draft":false,"unlisted":false,"editUrl":"https://github.com/maybebool/airpath-docs/tree/main/docs/core-concepts/grid-system.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"docsSidebar","previous":{"title":"Architecture Overview","permalink":"/airpath-docs/docs/core-concepts/architecture-overview"},"next":{"title":"Pathfinding Algorithm","permalink":"/airpath-docs/docs/core-concepts/pathfinding-algorithm"}}');var s=n(4848),l=n(8453);const d={sidebar_position:2},t="Grid System",o={},c=[{value:"What is the Grid?",id:"what-is-the-grid",level:2},{value:"Coordinate System",id:"coordinate-system",level:2},{value:"World Space (Unity)",id:"world-space-unity",level:3},{value:"Grid Space",id:"grid-space",level:3},{value:"Conversion Example",id:"conversion-example",level:3},{value:"Cell Size and Resolution",id:"cell-size-and-resolution",level:2},{value:"Trade-offs",id:"trade-offs",level:3},{value:"Height Sampling",id:"height-sampling",level:2},{value:"How Sampling Works",id:"how-sampling-works",level:3},{value:"When Heights are Sampled",id:"when-heights-are-sampled",level:3},{value:"Grid Origin",id:"grid-origin",level:2},{value:"Memory Layout",id:"memory-layout",level:2},{value:"Boundary Handling",id:"boundary-handling",level:2},{value:"See Also",id:"see-also",level:2}];function a(e){const i={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.header,{children:(0,s.jsx)(i.h1,{id:"grid-system",children:"Grid System"})}),"\n",(0,s.jsx)(i.p,{children:"AirPath uses a 2D grid projected over your terrain to represent navigable space. This page explains how the grid works and how to configure it."}),"\n",(0,s.jsx)(i.h2,{id:"what-is-the-grid",children:"What is the Grid?"}),"\n",(0,s.jsx)(i.p,{children:"The pathfinding grid is a 2D array of cells overlaid on your 3D terrain. Each cell stores:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Height"})," \u2014 Terrain elevation at that cell (sampled from your height provider)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Walkability"})," \u2014 Whether the cell can be traversed (all cells are walkable by default)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Pathfinding state"})," \u2014 Temporary data used during A* calculation"]}),"\n"]}),"\n",(0,s.jsx)("img",{src:n(554).A,alt:"How AirPath Works - Architecture Overview",width:"600"}),"\n",(0,s.jsx)(i.p,{children:"The A* algorithm finds paths through this grid, preferring cells with lower height costs."}),"\n",(0,s.jsx)(i.h2,{id:"coordinate-system",children:"Coordinate System"}),"\n",(0,s.jsx)(i.p,{children:"AirPath uses two coordinate systems:"}),"\n",(0,s.jsx)(i.h3,{id:"world-space-unity",children:"World Space (Unity)"}),"\n",(0,s.jsx)(i.p,{children:"Standard Unity coordinates \u2014 X, Y (up), Z."}),"\n",(0,s.jsx)(i.h3,{id:"grid-space",children:"Grid Space"}),"\n",(0,s.jsx)(i.p,{children:"2D integer coordinates \u2014 X and Y (note: grid Y = world Z)."}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:"World Space:              Grid Space:\r\n\r\n    Y (height)              (0,0)\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba X (GridWidth)\r\n    \u2502                         \u2502\r\n    \u2502                         \u2502  Each cell is one\r\n    \u2502                         \u2502  grid unit\r\n    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba X              \u2502\r\n   /                          \u25bc\r\n  Z                         Y (GridHeight)\r\nOrigin\n"})}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.strong,{children:"Mapping:"})}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Grid X \u2192 World X"}),"\n",(0,s.jsx)(i.li,{children:"Grid Y \u2192 World Z"}),"\n",(0,s.jsx)(i.li,{children:"World Y \u2192 Stored as height value in the cell"}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"conversion-example",children:"Conversion Example"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:"Terrain: 1000 x 1000 units\r\nGrid: 64 x 64 cells\r\nCell Size: 1000 / 64 = 15.625 units\r\n\r\nWorld position (150, 25, 200):\r\n  Grid X = Floor(150 / 15.625) = 9\r\n  Grid Y = Floor(200 / 15.625) = 12\r\n  Height = 25 (stored in cell)\r\n\r\nResult: Grid position (9, 12)\n"})}),"\n",(0,s.jsx)(i.h2,{id:"cell-size-and-resolution",children:"Cell Size and Resolution"}),"\n",(0,s.jsxs)(i.p,{children:["The grid resolution is controlled by ",(0,s.jsx)(i.strong,{children:"Samples Per Dimension"})," in ",(0,s.jsx)(i.code,{children:"PathfindingConfiguration"}),"."]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:"Cell Size = Terrain Size / Samples Per Dimension\n"})}),"\n",(0,s.jsxs)(i.table,{children:[(0,s.jsx)(i.thead,{children:(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.th,{children:"Terrain Size"}),(0,s.jsx)(i.th,{children:"Samples"}),(0,s.jsx)(i.th,{children:"Cell Size"}),(0,s.jsx)(i.th,{children:"Total Cells"})]})}),(0,s.jsxs)(i.tbody,{children:[(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"1000"}),(0,s.jsx)(i.td,{children:"32"}),(0,s.jsx)(i.td,{children:"31.25"}),(0,s.jsx)(i.td,{children:"1,024"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"1000"}),(0,s.jsx)(i.td,{children:"64"}),(0,s.jsx)(i.td,{children:"15.625"}),(0,s.jsx)(i.td,{children:"4,096"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"1000"}),(0,s.jsx)(i.td,{children:"128"}),(0,s.jsx)(i.td,{children:"7.8125"}),(0,s.jsx)(i.td,{children:"16,384"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"1000"}),(0,s.jsx)(i.td,{children:"256"}),(0,s.jsx)(i.td,{children:"3.906"}),(0,s.jsx)(i.td,{children:"65,536"})]})]})]}),"\n",(0,s.jsx)(i.h3,{id:"trade-offs",children:"Trade-offs"}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.strong,{children:"Higher resolution (more cells):"})}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"\u2705 More accurate paths"}),"\n",(0,s.jsx)(i.li,{children:"\u2705 Better navigation around small obstacles"}),"\n",(0,s.jsx)(i.li,{children:"\u274c More memory usage"}),"\n",(0,s.jsx)(i.li,{children:"\u274c Longer pathfinding time"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.strong,{children:"Lower resolution (fewer cells):"})}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"\u2705 Faster pathfinding"}),"\n",(0,s.jsx)(i.li,{children:"\u2705 Less memory"}),"\n",(0,s.jsx)(i.li,{children:"\u274c Paths may cut corners"}),"\n",(0,s.jsx)(i.li,{children:"\u274c Small terrain features ignored"}),"\n"]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Recommendation:"})," Start with 64\xd764. Increase if paths look jagged, decrease if pathfinding is slow."]}),"\n",(0,s.jsx)(i.h2,{id:"height-sampling",children:"Height Sampling"}),"\n",(0,s.jsxs)(i.p,{children:["When the grid initializes, it samples heights from your ",(0,s.jsx)(i.code,{children:"IHeightProvider"}),"."]}),"\n",(0,s.jsx)(i.h3,{id:"how-sampling-works",children:"How Sampling Works"}),"\n",(0,s.jsxs)(i.ol,{children:["\n",(0,s.jsx)(i.li,{children:"Grid divides terrain into cells"}),"\n",(0,s.jsx)(i.li,{children:"For each cell, samples the underlying terrain"}),"\n",(0,s.jsxs)(i.li,{children:["Takes the ",(0,s.jsx)(i.strong,{children:"maximum height"})," within the cell area"]}),"\n",(0,s.jsx)(i.li,{children:"Stores this height for pathfinding cost calculation"}),"\n"]}),"\n",(0,s.jsx)("img",{src:n(1906).A,alt:"How AirPath Works - Architecture Overview",width:"600"}),"\n",(0,s.jsx)(i.p,{children:"Using maximum height ensures agents don't clip through terrain peaks within a cell."}),"\n",(0,s.jsx)(i.h3,{id:"when-heights-are-sampled",children:"When Heights are Sampled"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Once"})," during ",(0,s.jsx)(i.code,{children:"PathfindingService.Initialize()"})]}),"\n",(0,s.jsx)(i.li,{children:"Cached for all subsequent pathfinding requests"}),"\n",(0,s.jsxs)(i.li,{children:["Call ",(0,s.jsx)(i.code,{children:"TerrainHeightProvider.InvalidateCache()"})," if terrain changes at runtime"]}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"grid-origin",children:"Grid Origin"}),"\n",(0,s.jsx)(i.p,{children:"The grid origin (cell 0,0) aligns with the terrain's transform position."}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-csharp",children:"// From TerrainHeightProvider\r\npublic Vector3 Origin => terrain.transform.position;\n"})}),"\n",(0,s.jsxs)(i.p,{children:["If your terrain is at ",(0,s.jsx)(i.code,{children:"(100, 0, 50)"}),", grid cell ",(0,s.jsx)(i.code,{children:"(0, 0)"})," maps to world position ",(0,s.jsx)(i.code,{children:"(100, 0, 50)"}),"."]}),"\n",(0,s.jsx)(i.h2,{id:"memory-layout",children:"Memory Layout"}),"\n",(0,s.jsxs)(i.p,{children:["Internally, the grid uses flat arrays indexed by ",(0,s.jsx)(i.code,{children:"y * width + x"}),":"]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:"Grid:           Array index:\r\n\u250c\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2510\r\n\u2502 0 \u2502 1 \u2502 2 \u2502   Row 0: indices 0, 1, 2\r\n\u251c\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2524\r\n\u2502 3 \u2502 4 \u2502 5 \u2502   Row 1: indices 3, 4, 5\r\n\u251c\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2524\r\n\u2502 6 \u2502 7 \u2502 8 \u2502   Row 2: indices 6, 7, 8\r\n\u2514\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2518\r\n\r\nindex = y * width + x\r\nposition = (index % width, index / width)\n"})}),"\n",(0,s.jsx)(i.p,{children:"This layout is optimized for cache-friendly access in Burst jobs."}),"\n",(0,s.jsx)(i.h2,{id:"boundary-handling",children:"Boundary Handling"}),"\n",(0,s.jsx)(i.p,{children:"Positions outside the grid can be handled two ways:"}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Auto-clamp (default):"})," Out-of-bounds positions are clamped to the nearest valid cell. A ",(0,s.jsx)(i.code,{children:"BoundaryViolationEvent"})," is published."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Strict:"})," Out-of-bounds positions return errors. Useful for debugging."]}),"\n",(0,s.jsxs)(i.p,{children:["Configure in ",(0,s.jsx)(i.code,{children:"PathfindingConfiguration"}),":"]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Auto Clamp Out Of Bounds"})," \u2014 Enable/disable clamping"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Show Clamp Warnings"})," \u2014 Log when clamping occurs"]}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"see-also",children:"See Also"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.a,{href:"../api-reference/grid-utilities",children:"Grid Utilities"})," \u2014 API for coordinate conversion"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.a,{href:"../advanced/performance-tuning",children:"Performance Tuning"})," \u2014 Optimizing grid resolution"]}),"\n"]})]})}function h(e={}){const{wrapper:i}={...(0,l.R)(),...e.components};return i?(0,s.jsx)(i,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},8453:(e,i,n)=>{n.d(i,{R:()=>d,x:()=>t});var r=n(6540);const s={},l=r.createContext(s);function d(e){const i=r.useContext(l);return r.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function t(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),r.createElement(l.Provider,{value:i},e.children)}}}]);