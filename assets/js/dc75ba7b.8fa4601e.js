"use strict";(globalThis.webpackChunkairpath_docs=globalThis.webpackChunkairpath_docs||[]).push([[7732],{8389:(e,n,i)=>{i.d(n,{A:()=>r});const r=i.p+"assets/images/Architecture-9e5e87930c60bc5c19e3cbd1638a3335.png"},8453:(e,n,i)=>{i.d(n,{R:()=>c,x:()=>d});var r=i(6540);const t={},s=r.createContext(t);function c(e){const n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),r.createElement(s.Provider,{value:n},e.children)}},8792:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>o,frontMatter:()=>c,metadata:()=>r,toc:()=>h});const r=JSON.parse('{"id":"core-concepts/architecture-overview","title":"Architecture Overview","description":"AirPath is designed around three core principles: performance, flexibility, and loose coupling. This page explains how the major systems work together.","source":"@site/docs/core-concepts/architecture-overview.md","sourceDirName":"core-concepts","slug":"/core-concepts/architecture-overview","permalink":"/airpath-docs/docs/core-concepts/architecture-overview","draft":false,"unlisted":false,"editUrl":"https://github.com/maybebool/airpath-docs/tree/main/docs/core-concepts/architecture-overview.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"docsSidebar","previous":{"title":"Core Concepts","permalink":"/airpath-docs/docs/category/core-concepts"},"next":{"title":"Grid System","permalink":"/airpath-docs/docs/core-concepts/grid-system"}}');var t=i(4848),s=i(8453);const c={sidebar_position:1},d="Architecture Overview",l={},h=[{value:"System Architecture",id:"system-architecture",level:2},{value:"Data Flow",id:"data-flow",level:2},{value:"1. Request",id:"1-request",level:3},{value:"2. Grid Conversion",id:"2-grid-conversion",level:3},{value:"3. A* Calculation",id:"3-a-calculation",level:3},{value:"4. Path Conversion",id:"4-path-conversion",level:3},{value:"5. Event Publication",id:"5-event-publication",level:3},{value:"Key Components",id:"key-components",level:2},{value:"PathfindingManager",id:"pathfindingmanager",level:3},{value:"PathfindingService",id:"pathfindingservice",level:3},{value:"IHeightProvider",id:"iheightprovider",level:3},{value:"PathfindingEventBus",id:"pathfindingeventbus",level:3},{value:"Configuration System",id:"configuration-system",level:3},{value:"Design Principles",id:"design-principles",level:2},{value:"Event-Driven Communication",id:"event-driven-communication",level:3},{value:"Interface Abstraction",id:"interface-abstraction",level:3},{value:"DOTS for Performance",id:"dots-for-performance",level:3},{value:"ScriptableObject Configuration",id:"scriptableobject-configuration",level:3},{value:"Thread Safety",id:"thread-safety",level:2},{value:"Next Steps",id:"next-steps",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"architecture-overview",children:"Architecture Overview"})}),"\n",(0,t.jsxs)(n.p,{children:["AirPath is designed around three core principles: ",(0,t.jsx)(n.strong,{children:"performance"}),", ",(0,t.jsx)(n.strong,{children:"flexibility"}),", and ",(0,t.jsx)(n.strong,{children:"loose coupling"}),". This page explains how the major systems work together."]}),"\n",(0,t.jsx)(n.h2,{id:"system-architecture",children:"System Architecture"}),"\n",(0,t.jsx)("img",{src:i(8389).A,alt:"How AirPath Works - Architecture Overview",width:"700"}),"\n",(0,t.jsx)(n.h2,{id:"data-flow",children:"Data Flow"}),"\n",(0,t.jsx)(n.p,{children:"When you request a path, here's what happens:"}),"\n",(0,t.jsx)(n.h3,{id:"1-request",children:"1. Request"}),"\n",(0,t.jsxs)(n.p,{children:["A pathfinding mode (MouseClick or TargetFollow) creates a ",(0,t.jsx)(n.code,{children:"PathRequest"})," with start/end positions."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"User clicks terrain \u2192 MouseClickMode \u2192 PathRequest created\n"})}),"\n",(0,t.jsx)(n.h3,{id:"2-grid-conversion",children:"2. Grid Conversion"}),"\n",(0,t.jsxs)(n.p,{children:["World positions are converted to grid coordinates using ",(0,t.jsx)(n.code,{children:"GridBoundaryHandler"}),". Out-of-bounds positions are clamped if configured."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"World (150, 0, 200) \u2192 Grid (9, 12)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"3-a-calculation",children:"3. A* Calculation"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"PathfindingService"})," schedules a Burst-compiled A* job. The job runs on a worker thread using NativeArrays from ",(0,t.jsx)(n.code,{children:"PathGridData"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Start (9, 12) \u2192 A* Algorithm \u2192 Path [indices...]\n"})}),"\n",(0,t.jsx)(n.h3,{id:"4-path-conversion",children:"4. Path Conversion"}),"\n",(0,t.jsx)(n.p,{children:"Grid indices are converted back to world positions with terrain height applied."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Grid path \u2192 World path with heights \u2192 List<Vector3>\n"})}),"\n",(0,t.jsx)(n.h3,{id:"5-event-publication",children:"5. Event Publication"}),"\n",(0,t.jsxs)(n.p,{children:["Results are published via ",(0,t.jsx)(n.code,{children:"PathfindingEventBus"}),". Any subscribed component receives the path."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"PathCalculatedEvent \u2192 Your agent controller \u2192 Agent follows path\n"})}),"\n",(0,t.jsx)(n.h2,{id:"key-components",children:"Key Components"}),"\n",(0,t.jsx)(n.h3,{id:"pathfindingmanager",children:"PathfindingManager"}),"\n",(0,t.jsx)(n.p,{children:"The central orchestrator. It:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Manages pathfinding modes (MouseClick, TargetFollow)"}),"\n",(0,t.jsx)(n.li,{children:"Initializes the PathfindingService"}),"\n",(0,t.jsx)(n.li,{children:"Handles mode switching"}),"\n",(0,t.jsx)(n.li,{children:"Publishes events for path requests and results"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"You configure it in the Inspector and rarely interact with it from code."}),"\n",(0,t.jsxs)(n.p,{children:["\u2192 ",(0,t.jsx)(n.a,{href:"../setup-guide/pathfinding-manager",children:"Setup Guide"})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"pathfindingservice",children:"PathfindingService"}),"\n",(0,t.jsx)(n.p,{children:"The core pathfinding engine. It:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Maintains the pathfinding grid (NativeArrays)"}),"\n",(0,t.jsx)(n.li,{children:"Executes Burst-compiled A* jobs"}),"\n",(0,t.jsx)(n.li,{children:"Handles coordinate conversion"}),"\n",(0,t.jsx)(n.li,{children:"Manages boundary clamping"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"For direct path calculation without modes, use this class."}),"\n",(0,t.jsxs)(n.p,{children:["\u2192 ",(0,t.jsx)(n.a,{href:"../api-reference/pathfinding-service",children:"API Reference"})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"iheightprovider",children:"IHeightProvider"}),"\n",(0,t.jsxs)(n.p,{children:["An interface that abstracts terrain data. AirPath doesn't depend on Unity Terrain directly, it asks an ",(0,t.jsx)(n.code,{children:"IHeightProvider"})," for height data."]}),"\n",(0,t.jsxs)(n.p,{children:["Built-in: ",(0,t.jsx)(n.code,{children:"TerrainHeightProvider"})," for Unity Terrain."]}),"\n",(0,t.jsxs)(n.p,{children:["Custom: Implement ",(0,t.jsx)(n.code,{children:"IHeightProvider"})," for procedural terrain, meshes, or voxels."]}),"\n",(0,t.jsxs)(n.p,{children:["\u2192 ",(0,t.jsx)(n.a,{href:"../api-reference/height-provider-interface",children:"API Reference"})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"pathfindingeventbus",children:"PathfindingEventBus"}),"\n",(0,t.jsx)(n.p,{children:"A ScriptableObject-based event system. Components communicate through events rather than direct references."}),"\n",(0,t.jsx)(n.p,{children:"Key events:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"PathRequestedEvent"})," \u2014 Path calculation started"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"PathCalculatedEvent"})," \u2014 Path calculation complete"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"PathfindingModeChangedEvent"})," \u2014 Mode switched"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["\u2192 ",(0,t.jsx)(n.a,{href:"../api-reference/events",children:"API Reference"})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"configuration-system",children:"Configuration System"}),"\n",(0,t.jsx)(n.p,{children:"All settings are stored in ScriptableObject assets:"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Asset"}),(0,t.jsx)(n.th,{children:"Purpose"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"PathfindingConfiguration"})}),(0,t.jsx)(n.td,{children:"Grid size, cost multipliers, boundary handling"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"VisualizationConfiguration"})}),(0,t.jsx)(n.td,{children:"Path line, cell colors, debug display"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"PathfindingEventBus"})}),(0,t.jsx)(n.td,{children:"Event system settings"})]})]})]}),"\n",(0,t.jsx)(n.p,{children:"This allows hot-swapping configurations and keeping scenes clean."}),"\n",(0,t.jsx)(n.h2,{id:"design-principles",children:"Design Principles"}),"\n",(0,t.jsx)(n.h3,{id:"event-driven-communication",children:"Event-Driven Communication"}),"\n",(0,t.jsx)(n.p,{children:"Components don't hold direct references to each other. Instead, they:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Publish"})," events when something happens"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Subscribe"})," to events they care about"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"This makes the system modular \u2014 you can remove visualization without breaking pathfinding."}),"\n",(0,t.jsx)(n.h3,{id:"interface-abstraction",children:"Interface Abstraction"}),"\n",(0,t.jsxs)(n.p,{children:["AirPath uses ",(0,t.jsx)(n.code,{children:"IHeightProvider"})," instead of depending on Unity Terrain directly. This means:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"You can use any height source"}),"\n",(0,t.jsx)(n.li,{children:"Testing is easier (mock height providers)"}),"\n",(0,t.jsx)(n.li,{children:"The core algorithm is terrain-agnostic"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"dots-for-performance",children:"DOTS for Performance"}),"\n",(0,t.jsx)(n.p,{children:"The A* algorithm is:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Burst-compiled"})," \u2014 Native code performance"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Job System"})," \u2014 Runs on worker threads"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"NativeArrays"})," \u2014 No GC allocation during pathfinding"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"This keeps pathfinding off the main thread and avoids frame hitches."}),"\n",(0,t.jsx)(n.h3,{id:"scriptableobject-configuration",children:"ScriptableObject Configuration"}),"\n",(0,t.jsx)(n.p,{children:"Settings live in assets, not scenes. Benefits:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Share configurations across scenes"}),"\n",(0,t.jsx)(n.li,{children:"Swap presets at runtime"}),"\n",(0,t.jsx)(n.li,{children:"Version control friendly"}),"\n",(0,t.jsx)(n.li,{children:"No scene modifications for setting changes"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"thread-safety",children:"Thread Safety"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Component"}),(0,t.jsx)(n.th,{children:"Thread"}),(0,t.jsx)(n.th,{children:"Notes"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"PathfindingManager"}),(0,t.jsx)(n.td,{children:"Main"}),(0,t.jsx)(n.td,{children:"Unity APIs require main thread"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"PathfindingService"}),(0,t.jsx)(n.td,{children:"Main"}),(0,t.jsx)(n.td,{children:"Schedules jobs, handles results"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"A* Job"}),(0,t.jsx)(n.td,{children:"Worker"}),(0,t.jsx)(n.td,{children:"Burst-compiled, no Unity API calls"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Event Bus"}),(0,t.jsx)(n.td,{children:"Main"}),(0,t.jsx)(n.td,{children:"Events processed on main thread"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Height Provider"}),(0,t.jsx)(n.td,{children:"Main"}),(0,t.jsx)(n.td,{children:"Called during initialization"})]})]})]}),"\n",(0,t.jsxs)(n.p,{children:["The A* calculation runs on a worker thread, but ",(0,t.jsx)(n.code,{children:"CalculatePath()"})," blocks until complete. For truly async pathfinding, consider wrapping in a coroutine."]}),"\n",(0,t.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"./grid-system",children:"Grid System"})," \u2014 How the pathfinding grid works"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"./pathfinding-algorithm",children:"Pathfinding Algorithm"})," \u2014 The A* implementation"]}),"\n"]})]})}function o(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}}}]);