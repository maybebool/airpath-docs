"use strict";(globalThis.webpackChunkairpath_docs=globalThis.webpackChunkairpath_docs||[]).push([[3446],{4342:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"advanced/extending-airpath","title":"Extending AirPath","description":"AirPath is designed to be extensible. This guide covers common extension points and patterns for customizing the system to your needs.","source":"@site/docs/advanced/extending-airpath.md","sourceDirName":"advanced","slug":"/advanced/extending-airpath","permalink":"/airpath-docs/docs/advanced/extending-airpath","draft":false,"unlisted":false,"editUrl":"https://github.com/maybebool/airpath-docs/tree/main/docs/advanced/extending-airpath.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"docsSidebar","previous":{"title":"Swarm Integration","permalink":"/airpath-docs/docs/advanced/swarm-integration"},"next":{"title":"Troubleshooting","permalink":"/airpath-docs/docs/troubleshooting"}}');var i=r(4848),a=r(8453);const o={sidebar_position:4},s="Extending AirPath",l={},d=[{value:"Extension Points Overview",id:"extension-points-overview",level:2},{value:"Custom Height Providers",id:"custom-height-providers",level:2},{value:"Interface Definition",id:"interface-definition",level:3},{value:"Example: Perlin Noise Terrain",id:"example-perlin-noise-terrain",level:3},{value:"Example: Mesh-Based Height Provider",id:"example-mesh-based-height-provider",level:3},{value:"Example: Flat Plane Provider",id:"example-flat-plane-provider",level:3},{value:"Height Provider Guidelines",id:"height-provider-guidelines",level:3},{value:"Custom Pathfinding Modes",id:"custom-pathfinding-modes",level:2},{value:"Pattern",id:"pattern",level:3},{value:"Example: Waypoint Patrol Mode",id:"example-waypoint-patrol-mode",level:3},{value:"Example: Click-to-Move Mode (RTS Style)",id:"example-click-to-move-mode-rts-style",level:3},{value:"Custom Agents",id:"custom-agents",level:2},{value:"Minimal Agent Template",id:"minimal-agent-template",level:3},{value:"Example: Vehicle Agent (Ground-Based)",id:"example-vehicle-agent-ground-based",level:3},{value:"Example: Flying Agent with Banking",id:"example-flying-agent-with-banking",level:3},{value:"Custom Configurations",id:"custom-configurations",level:2},{value:"Pattern",id:"pattern-1",level:3},{value:"Example: Difficulty Configuration",id:"example-difficulty-configuration",level:3},{value:"Event System Integration",id:"event-system-integration",level:2},{value:"Subscribing to Events",id:"subscribing-to-events",level:3},{value:"Publishing Custom Events",id:"publishing-custom-events",level:3},{value:"Integration Patterns",id:"integration-patterns",level:2},{value:"With Animation System",id:"with-animation-system",level:3},{value:"With Behavior Tree / FSM",id:"with-behavior-tree--fsm",level:3},{value:"With Object Pooling",id:"with-object-pooling",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Keep Extensions Loosely Coupled",id:"keep-extensions-loosely-coupled",level:3},{value:"Test Extensions Thoroughly",id:"test-extensions-thoroughly",level:3},{value:"Document Your Extensions",id:"document-your-extensions",level:3},{value:"Follow AirPath Patterns",id:"follow-airpath-patterns",level:3},{value:"See Also",id:"see-also",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"extending-airpath",children:"Extending AirPath"})}),"\n",(0,i.jsx)(n.p,{children:"AirPath is designed to be extensible. This guide covers common extension points and patterns for customizing the system to your needs."}),"\n",(0,i.jsx)(n.h2,{id:"extension-points-overview",children:"Extension Points Overview"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Extension Point"}),(0,i.jsx)(n.th,{children:"Interface/Base Class"}),(0,i.jsx)(n.th,{children:"Use Case"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Height Provider"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"IHeightProvider"})}),(0,i.jsx)(n.td,{children:"Custom terrain sources"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Pathfinding Mode"}),(0,i.jsx)(n.td,{children:"Component pattern"}),(0,i.jsx)(n.td,{children:"Custom start/end selection"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Agent"}),(0,i.jsx)(n.td,{children:"Component pattern"}),(0,i.jsx)(n.td,{children:"Custom movement behavior"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Configuration"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ConfigurationBase"})}),(0,i.jsx)(n.td,{children:"Custom settings assets"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Event Listener"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Subscribe<T>()"})}),(0,i.jsx)(n.td,{children:"Custom reactions to events"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"custom-height-providers",children:"Custom Height Providers"}),"\n",(0,i.jsx)(n.p,{children:"The most common extension is creating custom height providers for non-Unity-Terrain scenarios."}),"\n",(0,i.jsx)(n.h3,{id:"interface-definition",children:"Interface Definition"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"public interface IHeightProvider\r\n{\r\n    float CellSize { get; }\r\n    Vector3 Origin { get; }\r\n    int GridWidth { get; }\r\n    int GridHeight { get; }\r\n    \r\n    float GetHeightAt(int x, int y);\r\n    float[] SampleHeights(int samplesPerDimension);\r\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"example-perlin-noise-terrain",children:"Example: Perlin Noise Terrain"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'using UnityEngine;\r\nusing PlatypusIdeas.AirPath.Runtime.Core.Height;\r\n\r\npublic class PerlinHeightProvider : MonoBehaviour, IHeightProvider\r\n{\r\n    [Header("Grid Settings")]\r\n    [SerializeField] private float worldSize = 500f;\r\n    [SerializeField] private int resolution = 64;\r\n    \r\n    [Header("Noise Settings")]\r\n    [SerializeField] private float noiseScale = 0.02f;\r\n    [SerializeField] private float heightMultiplier = 50f;\r\n    [SerializeField] private Vector2 noiseOffset;\r\n    \r\n    private float[] _cachedHeights;\r\n    \r\n    public float CellSize => worldSize / resolution;\r\n    public Vector3 Origin => transform.position;\r\n    public int GridWidth => resolution;\r\n    public int GridHeight => resolution;\r\n    \r\n    public float GetHeightAt(int x, int y)\r\n    {\r\n        if (x < 0 || x >= resolution || y < 0 || y >= resolution)\r\n            return 0f;\r\n        \r\n        float worldX = Origin.x + x * CellSize;\r\n        float worldZ = Origin.z + y * CellSize;\r\n        \r\n        float noise = Mathf.PerlinNoise(\r\n            (worldX + noiseOffset.x) * noiseScale,\r\n            (worldZ + noiseOffset.y) * noiseScale\r\n        );\r\n        \r\n        return noise * heightMultiplier;\r\n    }\r\n    \r\n    public float[] SampleHeights(int samplesPerDimension)\r\n    {\r\n        var heights = new float[samplesPerDimension * samplesPerDimension];\r\n        \r\n        for (int y = 0; y < samplesPerDimension; y++)\r\n        {\r\n            for (int x = 0; x < samplesPerDimension; x++)\r\n            {\r\n                int index = y * samplesPerDimension + x;\r\n                heights[index] = GetHeightAt(x, y);\r\n            }\r\n        }\r\n        \r\n        _cachedHeights = heights;\r\n        return heights;\r\n    }\r\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"example-mesh-based-height-provider",children:"Example: Mesh-Based Height Provider"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"using UnityEngine;\r\nusing PlatypusIdeas.AirPath.Runtime.Core.Height;\r\n\r\npublic class MeshHeightProvider : MonoBehaviour, IHeightProvider\r\n{\r\n    [SerializeField] private MeshCollider meshCollider;\r\n    [SerializeField] private float worldSize = 100f;\r\n    [SerializeField] private int resolution = 64;\r\n    [SerializeField] private float raycastHeight = 100f;\r\n    \r\n    public float CellSize => worldSize / resolution;\r\n    public Vector3 Origin => transform.position;\r\n    public int GridWidth => resolution;\r\n    public int GridHeight => resolution;\r\n    \r\n    public float GetHeightAt(int x, int y)\r\n    {\r\n        float worldX = Origin.x + x * CellSize + CellSize * 0.5f;\r\n        float worldZ = Origin.z + y * CellSize + CellSize * 0.5f;\r\n        \r\n        var rayOrigin = new Vector3(worldX, raycastHeight, worldZ);\r\n        \r\n        if (Physics.Raycast(rayOrigin, Vector3.down, out RaycastHit hit, raycastHeight * 2f))\r\n        {\r\n            return hit.point.y;\r\n        }\r\n        \r\n        return 0f;\r\n    }\r\n    \r\n    public float[] SampleHeights(int samplesPerDimension)\r\n    {\r\n        var heights = new float[samplesPerDimension * samplesPerDimension];\r\n        \r\n        for (int y = 0; y < samplesPerDimension; y++)\r\n        {\r\n            for (int x = 0; x < samplesPerDimension; x++)\r\n            {\r\n                heights[y * samplesPerDimension + x] = GetHeightAt(x, y);\r\n            }\r\n        }\r\n        \r\n        return heights;\r\n    }\r\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"example-flat-plane-provider",children:"Example: Flat Plane Provider"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"public class FlatHeightProvider : MonoBehaviour, IHeightProvider\r\n{\r\n    [SerializeField] private float worldSize = 100f;\r\n    [SerializeField] private int resolution = 64;\r\n    [SerializeField] private float constantHeight = 0f;\r\n    \r\n    public float CellSize => worldSize / resolution;\r\n    public Vector3 Origin => transform.position;\r\n    public int GridWidth => resolution;\r\n    public int GridHeight => resolution;\r\n    \r\n    public float GetHeightAt(int x, int y) => constantHeight;\r\n    \r\n    public float[] SampleHeights(int samplesPerDimension)\r\n    {\r\n        var heights = new float[samplesPerDimension * samplesPerDimension];\r\n        \r\n        for (int i = 0; i < heights.Length; i++)\r\n        {\r\n            heights[i] = constantHeight;\r\n        }\r\n        \r\n        return heights;\r\n    }\r\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"height-provider-guidelines",children:"Height Provider Guidelines"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Cache heights"})," when possible \u2014 ",(0,i.jsx)(n.code,{children:"SampleHeights()"})," is called during initialization"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Handle out-of-bounds"})," gracefully \u2014 return 0 or clamp to valid range"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Thread safety"})," \u2014 ",(0,i.jsx)(n.code,{children:"GetHeightAt()"})," may be called from jobs (avoid Unity API)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Origin alignment"})," \u2014 Ensure ",(0,i.jsx)(n.code,{children:"Origin"})," matches your world setup"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"custom-pathfinding-modes",children:"Custom Pathfinding Modes"}),"\n",(0,i.jsx)(n.p,{children:"Create modes for specific gameplay needs."}),"\n",(0,i.jsx)(n.h3,{id:"pattern",children:"Pattern"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"public class CustomPathfindingMode : MonoBehaviour\r\n{\r\n    private PathfindingManager _manager;\r\n    \r\n    public void Initialize(PathfindingManager manager)\r\n    {\r\n        _manager = manager;\r\n    }\r\n    \r\n    public void UpdateMode()\r\n    {\r\n        // Your logic to determine start/end positions\r\n        // Call _manager.RequestPath(start, end) when appropriate\r\n    }\r\n    \r\n    public void Cleanup()\r\n    {\r\n        // Clean up resources\r\n    }\r\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"example-waypoint-patrol-mode",children:"Example: Waypoint Patrol Mode"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'using System.Collections.Generic;\r\nusing UnityEngine;\r\nusing PlatypusIdeas.AirPath.Runtime.Core.Pathfinding;\r\nusing PlatypusIdeas.AirPath.Runtime.Events;\r\n\r\npublic class PatrolMode : MonoBehaviour\r\n{\r\n    [SerializeField] private List<Transform> waypoints;\r\n    [SerializeField] private float arrivalDistance = 3f;\r\n    [SerializeField] private bool loop = true;\r\n    \r\n    private PathfindingManager _manager;\r\n    private int _currentWaypointIndex;\r\n    private Vector3 _lastPosition;\r\n    \r\n    public void Initialize(PathfindingManager manager)\r\n    {\r\n        _manager = manager;\r\n        _currentWaypointIndex = 0;\r\n        \r\n        this.Subscribe<PathCalculatedEvent>(OnPathCalculated);\r\n        \r\n        RequestPathToCurrentWaypoint();\r\n    }\r\n    \r\n    public void UpdateMode()\r\n    {\r\n        if (waypoints == null || waypoints.Count == 0)\r\n            return;\r\n        \r\n        // Check if reached current waypoint\r\n        var currentWaypoint = waypoints[_currentWaypointIndex];\r\n        var distance = Vector3.Distance(_lastPosition, currentWaypoint.position);\r\n        \r\n        if (distance < arrivalDistance)\r\n        {\r\n            AdvanceToNextWaypoint();\r\n        }\r\n    }\r\n    \r\n    private void AdvanceToNextWaypoint()\r\n    {\r\n        _currentWaypointIndex++;\r\n        \r\n        if (_currentWaypointIndex >= waypoints.Count)\r\n        {\r\n            if (loop)\r\n            {\r\n                _currentWaypointIndex = 0;\r\n            }\r\n            else\r\n            {\r\n                Debug.Log("Patrol complete");\r\n                return;\r\n            }\r\n        }\r\n        \r\n        RequestPathToCurrentWaypoint();\r\n    }\r\n    \r\n    private void RequestPathToCurrentWaypoint()\r\n    {\r\n        if (waypoints == null || waypoints.Count == 0)\r\n            return;\r\n        \r\n        var start = _manager.transform.position;\r\n        var end = waypoints[_currentWaypointIndex].position;\r\n        \r\n        // Use PathfindingService directly or trigger via manager\r\n        Debug.Log($"Requesting path to waypoint {_currentWaypointIndex}");\r\n    }\r\n    \r\n    private void OnPathCalculated(PathCalculatedEvent evt)\r\n    {\r\n        if (evt.Success && evt.WorldPath.Count > 0)\r\n        {\r\n            _lastPosition = evt.WorldPath[evt.WorldPath.Count - 1];\r\n        }\r\n    }\r\n    \r\n    public void Cleanup()\r\n    {\r\n        EventBusExtensions.Unsubscribe<PathCalculatedEvent>(OnPathCalculated);\r\n    }\r\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"example-click-to-move-mode-rts-style",children:"Example: Click-to-Move Mode (RTS Style)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'using UnityEngine;\r\nusing PlatypusIdeas.AirPath.Runtime.Core.Pathfinding;\r\n\r\npublic class ClickToMoveMode : MonoBehaviour\r\n{\r\n    [SerializeField] private Camera gameCamera;\r\n    [SerializeField] private LayerMask groundLayer;\r\n    [SerializeField] private KeyCode moveKey = KeyCode.Mouse1;\r\n    \r\n    private PathfindingManager _manager;\r\n    private PathfindingService _pathfindingService;\r\n    \r\n    public void Initialize(PathfindingManager manager, PathfindingService service)\r\n    {\r\n        _manager = manager;\r\n        _pathfindingService = service;\r\n        \r\n        if (gameCamera == null)\r\n            gameCamera = Camera.main;\r\n    }\r\n    \r\n    public void UpdateMode()\r\n    {\r\n        if (Input.GetKeyDown(moveKey))\r\n        {\r\n            TryMoveToMousePosition();\r\n        }\r\n    }\r\n    \r\n    private void TryMoveToMousePosition()\r\n    {\r\n        var ray = gameCamera.ScreenPointToRay(Input.mousePosition);\r\n        \r\n        if (Physics.Raycast(ray, out RaycastHit hit, 1000f, groundLayer))\r\n        {\r\n            var start = _manager.transform.position;\r\n            var end = hit.point;\r\n            \r\n            var result = _pathfindingService.CalculatePath(start, end, 10f);\r\n            \r\n            if (result.Success)\r\n            {\r\n                Debug.Log($"Path found with {result.Path.Count} waypoints");\r\n                // Dispatch path to your movement system\r\n            }\r\n        }\r\n    }\r\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"custom-agents",children:"Custom Agents"}),"\n",(0,i.jsx)(n.p,{children:"Build agents with specific movement behaviors."}),"\n",(0,i.jsx)(n.h3,{id:"minimal-agent-template",children:"Minimal Agent Template"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"using System.Collections.Generic;\r\nusing UnityEngine;\r\n\r\npublic abstract class BaseAgent : MonoBehaviour\r\n{\r\n    public abstract Vector3 CurrentPosition { get; }\r\n    public abstract void SetPath(List<Vector3> path, bool teleportToStart = true);\r\n    public abstract void StopMovement();\r\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"example-vehicle-agent-ground-based",children:"Example: Vehicle Agent (Ground-Based)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"using System.Collections.Generic;\r\nusing UnityEngine;\r\n\r\npublic class VehicleAgent : BaseAgent\r\n{\r\n    [SerializeField] private float maxSpeed = 15f;\r\n    [SerializeField] private float acceleration = 5f;\r\n    [SerializeField] private float turnSpeed = 90f;\r\n    [SerializeField] private float waypointRadius = 3f;\r\n    \r\n    private List<Vector3> _path;\r\n    private int _currentIndex;\r\n    private float _currentSpeed;\r\n    private bool _isMoving;\r\n    \r\n    public override Vector3 CurrentPosition => transform.position;\r\n    \r\n    public override void SetPath(List<Vector3> path, bool teleportToStart = true)\r\n    {\r\n        _path = new List<Vector3>(path);\r\n        _currentIndex = 0;\r\n        _currentSpeed = 0f;\r\n        _isMoving = true;\r\n        \r\n        if (teleportToStart && _path.Count > 0)\r\n        {\r\n            transform.position = _path[0];\r\n            _currentIndex = 1;\r\n        }\r\n    }\r\n    \r\n    public override void StopMovement()\r\n    {\r\n        _isMoving = false;\r\n        _currentSpeed = 0f;\r\n    }\r\n    \r\n    private void Update()\r\n    {\r\n        if (!_isMoving || _path == null || _currentIndex >= _path.Count)\r\n            return;\r\n        \r\n        var target = _path[_currentIndex];\r\n        target.y = transform.position.y; // Keep on ground\r\n        \r\n        var direction = (target - transform.position).normalized;\r\n        \r\n        // Rotate toward target\r\n        if (direction != Vector3.zero)\r\n        {\r\n            var targetRotation = Quaternion.LookRotation(direction);\r\n            transform.rotation = Quaternion.RotateTowards(\r\n                transform.rotation,\r\n                targetRotation,\r\n                turnSpeed * Time.deltaTime\r\n            );\r\n        }\r\n        \r\n        // Accelerate/decelerate based on angle to target\r\n        var angleToTarget = Vector3.Angle(transform.forward, direction);\r\n        var speedMultiplier = Mathf.Clamp01(1f - angleToTarget / 90f);\r\n        \r\n        var targetSpeed = maxSpeed * speedMultiplier;\r\n        _currentSpeed = Mathf.MoveTowards(_currentSpeed, targetSpeed, acceleration * Time.deltaTime);\r\n        \r\n        // Move forward\r\n        transform.position += transform.forward * _currentSpeed * Time.deltaTime;\r\n        \r\n        // Check waypoint arrival\r\n        if (Vector3.Distance(transform.position, target) < waypointRadius)\r\n        {\r\n            _currentIndex++;\r\n            \r\n            if (_currentIndex >= _path.Count)\r\n            {\r\n                StopMovement();\r\n            }\r\n        }\r\n    }\r\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"example-flying-agent-with-banking",children:"Example: Flying Agent with Banking"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"using System.Collections.Generic;\r\nusing UnityEngine;\r\n\r\npublic class BankingFlyerAgent : BaseAgent\r\n{\r\n    [SerializeField] private float moveSpeed = 20f;\r\n    [SerializeField] private float turnSpeed = 3f;\r\n    [SerializeField] private float maxBankAngle = 45f;\r\n    [SerializeField] private float bankSpeed = 2f;\r\n    [SerializeField] private float waypointRadius = 5f;\r\n    \r\n    [SerializeField] private Transform modelTransform; // Child with visual\r\n    \r\n    private List<Vector3> _path;\r\n    private int _currentIndex;\r\n    private bool _isMoving;\r\n    private float _currentBank;\r\n    \r\n    public override Vector3 CurrentPosition => transform.position;\r\n    \r\n    public override void SetPath(List<Vector3> path, bool teleportToStart = true)\r\n    {\r\n        _path = new List<Vector3>(path);\r\n        _currentIndex = 0;\r\n        _isMoving = true;\r\n        \r\n        if (teleportToStart && _path.Count > 0)\r\n        {\r\n            transform.position = _path[0];\r\n            if (_path.Count > 1)\r\n            {\r\n                transform.LookAt(_path[1]);\r\n            }\r\n        }\r\n    }\r\n    \r\n    public override void StopMovement()\r\n    {\r\n        _isMoving = false;\r\n    }\r\n    \r\n    private void Update()\r\n    {\r\n        if (!_isMoving || _path == null || _currentIndex >= _path.Count)\r\n            return;\r\n        \r\n        var target = _path[_currentIndex];\r\n        var direction = (target - transform.position).normalized;\r\n        \r\n        // Calculate turn direction for banking\r\n        var turnDirection = Vector3.Cross(transform.forward, direction).y;\r\n        var targetBank = -turnDirection * maxBankAngle;\r\n        _currentBank = Mathf.Lerp(_currentBank, targetBank, bankSpeed * Time.deltaTime);\r\n        \r\n        // Apply banking to model\r\n        if (modelTransform != null)\r\n        {\r\n            modelTransform.localRotation = Quaternion.Euler(0, 0, _currentBank);\r\n        }\r\n        \r\n        // Rotate toward target\r\n        var targetRotation = Quaternion.LookRotation(direction);\r\n        transform.rotation = Quaternion.Slerp(\r\n            transform.rotation,\r\n            targetRotation,\r\n            turnSpeed * Time.deltaTime\r\n        );\r\n        \r\n        // Move forward\r\n        transform.position += transform.forward * moveSpeed * Time.deltaTime;\r\n        \r\n        // Check waypoint arrival\r\n        if (Vector3.Distance(transform.position, target) < waypointRadius)\r\n        {\r\n            _currentIndex++;\r\n            \r\n            if (_currentIndex >= _path.Count)\r\n            {\r\n                StopMovement();\r\n            }\r\n        }\r\n    }\r\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"custom-configurations",children:"Custom Configurations"}),"\n",(0,i.jsxs)(n.p,{children:["Extend ",(0,i.jsx)(n.code,{children:"ConfigurationBase"})," for your own settings."]}),"\n",(0,i.jsx)(n.h3,{id:"pattern-1",children:"Pattern"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'using UnityEngine;\r\nusing PlatypusIdeas.AirPath.Runtime.Configuration;\r\n\r\n[CreateAssetMenu(menuName = "Pathfinding/Configurations/My Custom Config")]\r\npublic class MyCustomConfiguration : ConfigurationBase\r\n{\r\n    [Header("My Settings")]\r\n    [SerializeField] private float myValue = 10f;\r\n    [SerializeField] private bool myFlag = true;\r\n    \r\n    public float MyValue => myValue;\r\n    public bool MyFlag => myFlag;\r\n    \r\n    public override bool Validate()\r\n    {\r\n        bool valid = true;\r\n        \r\n        if (myValue < 0)\r\n        {\r\n            Debug.LogWarning($"[{ConfigurationName}] MyValue cannot be negative");\r\n            myValue = 0;\r\n            valid = false;\r\n        }\r\n        \r\n        return valid;\r\n    }\r\n    \r\n    public override void ResetToDefaults()\r\n    {\r\n        myValue = 10f;\r\n        myFlag = true;\r\n    }\r\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"example-difficulty-configuration",children:"Example: Difficulty Configuration"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'[CreateAssetMenu(menuName = "Pathfinding/Configurations/Difficulty Config")]\r\npublic class DifficultyConfiguration : ConfigurationBase\r\n{\r\n    [Header("AI Settings")]\r\n    [SerializeField, Range(0.5f, 2f)] private float aiSpeedMultiplier = 1f;\r\n    [SerializeField, Range(0.1f, 1f)] private float pathUpdateFrequency = 0.5f;\r\n    [SerializeField] private bool aiUsesShortcuts = false;\r\n    \r\n    [Header("Player Assistance")]\r\n    [SerializeField] private bool showPathPreview = true;\r\n    [SerializeField] private float pathPreviewDistance = 50f;\r\n    \r\n    public float AISpeedMultiplier => aiSpeedMultiplier;\r\n    public float PathUpdateFrequency => pathUpdateFrequency;\r\n    public bool AIUsesShortcuts => aiUsesShortcuts;\r\n    public bool ShowPathPreview => showPathPreview;\r\n    public float PathPreviewDistance => pathPreviewDistance;\r\n    \r\n    public override bool Validate()\r\n    {\r\n        return true;\r\n    }\r\n    \r\n    public override void ResetToDefaults()\r\n    {\r\n        aiSpeedMultiplier = 1f;\r\n        pathUpdateFrequency = 0.5f;\r\n        aiUsesShortcuts = false;\r\n        showPathPreview = true;\r\n        pathPreviewDistance = 50f;\r\n    }\r\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"event-system-integration",children:"Event System Integration"}),"\n",(0,i.jsx)(n.p,{children:"Build reactive systems using the event bus."}),"\n",(0,i.jsx)(n.h3,{id:"subscribing-to-events",children:"Subscribing to Events"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'using PlatypusIdeas.AirPath.Runtime.Events;\r\n\r\npublic class PathfindingAnalytics : MonoBehaviour\r\n{\r\n    private int _totalPathsCalculated;\r\n    private float _totalCalculationTime;\r\n    private int _failedPaths;\r\n    \r\n    private void Start()\r\n    {\r\n        this.Subscribe<PathCalculatedEvent>(OnPathCalculated);\r\n        this.Subscribe<PathfindingErrorEvent>(OnError);\r\n        this.Subscribe<BoundaryViolationEvent>(OnBoundaryViolation);\r\n    }\r\n    \r\n    private void OnDestroy()\r\n    {\r\n        EventBusExtensions.Unsubscribe<PathCalculatedEvent>(OnPathCalculated);\r\n        EventBusExtensions.Unsubscribe<PathfindingErrorEvent>(OnError);\r\n        EventBusExtensions.Unsubscribe<BoundaryViolationEvent>(OnBoundaryViolation);\r\n    }\r\n    \r\n    private void OnPathCalculated(PathCalculatedEvent evt)\r\n    {\r\n        _totalPathsCalculated++;\r\n        _totalCalculationTime += evt.CalculationTime;\r\n        \r\n        if (!evt.Success)\r\n            _failedPaths++;\r\n        \r\n        Debug.Log($"Paths: {_totalPathsCalculated}, " +\r\n                  $"Avg Time: {_totalCalculationTime / _totalPathsCalculated:F2}ms, " +\r\n                  $"Failed: {_failedPaths}");\r\n    }\r\n    \r\n    private void OnError(PathfindingErrorEvent evt)\r\n    {\r\n        Debug.LogError($"Pathfinding error: {evt.ErrorMessage}");\r\n        \r\n        if (evt.IsCritical)\r\n        {\r\n            // Handle critical errors\r\n        }\r\n    }\r\n    \r\n    private void OnBoundaryViolation(BoundaryViolationEvent evt)\r\n    {\r\n        Debug.LogWarning($"Boundary violation at {evt.OriginalPosition}, " +\r\n                        $"clamped to {evt.ClampedPosition}");\r\n    }\r\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"publishing-custom-events",children:"Publishing Custom Events"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'// Define custom event\r\npublic class CustomPathEvent\r\n{\r\n    public Vector3 Position { get; }\r\n    public string Message { get; }\r\n    \r\n    public CustomPathEvent(Vector3 position, string message)\r\n    {\r\n        Position = position;\r\n        Message = message;\r\n    }\r\n}\r\n\r\n// Publish\r\nEventBusExtensions.Publish(new CustomPathEvent(\r\n    transform.position,\r\n    "Agent reached checkpoint"\r\n));\r\n\r\n// Subscribe\r\nthis.Subscribe<CustomPathEvent>(evt =>\r\n{\r\n    Debug.Log($"{evt.Message} at {evt.Position}");\r\n});\n'})}),"\n",(0,i.jsx)(n.h2,{id:"integration-patterns",children:"Integration Patterns"}),"\n",(0,i.jsx)(n.h3,{id:"with-animation-system",children:"With Animation System"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'public class AnimatedAgent : MonoBehaviour\r\n{\r\n    [SerializeField] private Animator animator;\r\n    [SerializeField] private float moveSpeed = 5f;\r\n    \r\n    private static readonly int SpeedHash = Animator.StringToHash("Speed");\r\n    private static readonly int FlyingHash = Animator.StringToHash("IsFlying");\r\n    \r\n    private List<Vector3> _path;\r\n    private int _currentIndex;\r\n    private float _currentSpeed;\r\n    \r\n    public void SetPath(List<Vector3> path)\r\n    {\r\n        _path = path;\r\n        _currentIndex = 0;\r\n        animator.SetBool(FlyingHash, true);\r\n    }\r\n    \r\n    private void Update()\r\n    {\r\n        if (_path == null || _currentIndex >= _path.Count)\r\n        {\r\n            _currentSpeed = Mathf.Lerp(_currentSpeed, 0f, Time.deltaTime * 5f);\r\n            animator.SetFloat(SpeedHash, _currentSpeed);\r\n            return;\r\n        }\r\n        \r\n        // Movement logic...\r\n        _currentSpeed = Mathf.Lerp(_currentSpeed, moveSpeed, Time.deltaTime * 3f);\r\n        animator.SetFloat(SpeedHash, _currentSpeed);\r\n    }\r\n    \r\n    private void OnPathComplete()\r\n    {\r\n        animator.SetBool(FlyingHash, false);\r\n    }\r\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"with-behavior-tree--fsm",children:"With Behavior Tree / FSM"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"// Example integration point for behavior trees\r\npublic class PathfindingBTNode\r\n{\r\n    private PathfindingService _pathfindingService;\r\n    private List<Vector3> _currentPath;\r\n    \r\n    public bool HasPath => _currentPath != null && _currentPath.Count > 0;\r\n    public List<Vector3> CurrentPath => _currentPath;\r\n    \r\n    public bool RequestPath(Vector3 start, Vector3 end, float heightOffset)\r\n    {\r\n        var result = _pathfindingService.CalculatePath(start, end, heightOffset);\r\n        \r\n        if (result.Success)\r\n        {\r\n            _currentPath = result.Path;\r\n            return true;\r\n        }\r\n        \r\n        _currentPath = null;\r\n        return false;\r\n    }\r\n    \r\n    public void ClearPath()\r\n    {\r\n        _currentPath = null;\r\n    }\r\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"with-object-pooling",children:"With Object Pooling"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"public class PooledAgentManager : MonoBehaviour\r\n{\r\n    [SerializeField] private GameObject agentPrefab;\r\n    [SerializeField] private int poolSize = 20;\r\n    \r\n    private Queue<GameObject> _pool = new();\r\n    private List<GameObject> _activeAgents = new();\r\n    \r\n    private void Start()\r\n    {\r\n        // Pre-populate pool\r\n        for (int i = 0; i < poolSize; i++)\r\n        {\r\n            var agent = Instantiate(agentPrefab, transform);\r\n            agent.SetActive(false);\r\n            _pool.Enqueue(agent);\r\n        }\r\n        \r\n        this.Subscribe<PathCalculatedEvent>(OnPathCalculated);\r\n    }\r\n    \r\n    public GameObject SpawnAgent(Vector3 position)\r\n    {\r\n        GameObject agent;\r\n        \r\n        if (_pool.Count > 0)\r\n        {\r\n            agent = _pool.Dequeue();\r\n        }\r\n        else\r\n        {\r\n            agent = Instantiate(agentPrefab, transform);\r\n        }\r\n        \r\n        agent.transform.position = position;\r\n        agent.SetActive(true);\r\n        _activeAgents.Add(agent);\r\n        \r\n        return agent;\r\n    }\r\n    \r\n    public void ReturnAgent(GameObject agent)\r\n    {\r\n        agent.SetActive(false);\r\n        _activeAgents.Remove(agent);\r\n        _pool.Enqueue(agent);\r\n    }\r\n    \r\n    private void OnPathCalculated(PathCalculatedEvent evt)\r\n    {\r\n        // Assign path to active agents\r\n        foreach (var agent in _activeAgents)\r\n        {\r\n            var agentComponent = agent.GetComponent<BaseAgent>();\r\n            agentComponent?.SetPath(evt.WorldPath, teleportToStart: false);\r\n        }\r\n    }\r\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,i.jsx)(n.h3,{id:"keep-extensions-loosely-coupled",children:"Keep Extensions Loosely Coupled"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Use events instead of direct references where possible"}),"\n",(0,i.jsx)(n.li,{children:"Implement interfaces rather than inheriting from concrete classes"}),"\n",(0,i.jsx)(n.li,{children:"Use ScriptableObjects for configuration"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"test-extensions-thoroughly",children:"Test Extensions Thoroughly"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Verify height providers return sensible values at boundaries"}),"\n",(0,i.jsx)(n.li,{children:"Test pathfinding modes with edge cases (no path found, target out of bounds)"}),"\n",(0,i.jsx)(n.li,{children:"Profile custom agents for performance"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"document-your-extensions",children:"Document Your Extensions"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Add XML documentation to public methods"}),"\n",(0,i.jsx)(n.li,{children:"Include usage examples in comments"}),"\n",(0,i.jsxs)(n.li,{children:["Create configuration tooltips with ",(0,i.jsx)(n.code,{children:'[Tooltip("...")]'})]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"follow-airpath-patterns",children:"Follow AirPath Patterns"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Use the event bus for cross-system communication"}),"\n",(0,i.jsxs)(n.li,{children:["Extend ",(0,i.jsx)(n.code,{children:"ConfigurationBase"})," for settings"]}),"\n",(0,i.jsxs)(n.li,{children:["Implement ",(0,i.jsx)(n.code,{children:"Validate()"})," for configuration validation"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"see-also",children:"See Also"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"../api-reference/height-provider-interface",children:"Height Provider Interface"})," \u2014 Interface details"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"./pathfinding-modes",children:"Pathfinding Modes"})," \u2014 Built-in mode reference"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"./swarm-integration",children:"Swarm Integration"})," \u2014 Agent implementation examples"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"../api-reference/events",children:"Events"})," \u2014 Complete event reference"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>s});var t=r(6540);const i={},a=t.createContext(i);function o(e){const n=t.useContext(a);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);