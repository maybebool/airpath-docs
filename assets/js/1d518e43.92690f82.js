"use strict";(globalThis.webpackChunkairpath_docs=globalThis.webpackChunkairpath_docs||[]).push([[3116],{4600:(e,n,r)=>{r.d(n,{A:()=>t});const t=r.p+"assets/images/swarm-architecture-30490c6e5698a55b8c965598c8bc118d.png"},5695:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>c,frontMatter:()=>a,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"advanced/swarm-integration","title":"Swarm Integration","description":"AirPath includes a swarm system for controlling multiple agents (birds, drones, etc.) that follow calculated paths. This page explains how to set up and customize swarm behavior.","source":"@site/docs/advanced/swarm-integration.md","sourceDirName":"advanced","slug":"/advanced/swarm-integration","permalink":"/airpath-docs/docs/advanced/swarm-integration","draft":false,"unlisted":false,"editUrl":"https://github.com/maybebool/airpath-docs/tree/main/docs/advanced/swarm-integration.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"docsSidebar","previous":{"title":"Pathfinding Modes","permalink":"/airpath-docs/docs/advanced/pathfinding-modes"},"next":{"title":"Extending AirPath","permalink":"/airpath-docs/docs/advanced/extending-airpath"}}');var i=r(4848),s=r(8453);const a={sidebar_position:3},d="Swarm Integration",l={},o=[{value:"Overview",id:"overview",level:2},{value:"Architecture",id:"architecture",level:2},{value:"Quick Setup",id:"quick-setup",level:2},{value:"Step 1: Create Configuration Assets",id:"step-1-create-configuration-assets",level:3},{value:"Step 2: Create Agent Prefab",id:"step-2-create-agent-prefab",level:3},{value:"Step 3: Add SwarmDemoController",id:"step-3-add-swarmdemocontroller",level:3},{value:"Step 4: Connect to PathfindingManager",id:"step-4-connect-to-pathfindingmanager",level:3},{value:"SwarmConfiguration Reference",id:"swarmconfiguration-reference",level:2},{value:"Swarm Settings",id:"swarm-settings",level:3},{value:"Swarm Behavior",id:"swarm-behavior",level:3},{value:"Movement Settings",id:"movement-settings",level:3},{value:"DemoAirAgent Reference",id:"demoairagent-reference",level:2},{value:"Inspector Settings",id:"inspector-settings",level:3},{value:"Key Methods",id:"key-methods",level:3},{value:"SwarmDemoController Reference",id:"swarmdemocontroller-reference",level:2},{value:"Inspector Settings",id:"inspector-settings-1",level:3},{value:"Properties",id:"properties",level:3},{value:"Methods",id:"methods",level:3},{value:"Automatic Behavior",id:"automatic-behavior",level:3},{value:"Events",id:"events",level:2},{value:"SwarmUpdateEvent",id:"swarmupdateevent",level:3},{value:"Path Smoothing",id:"path-smoothing",level:2},{value:"How It Works",id:"how-it-works",level:3},{value:"Configuration",id:"configuration",level:3},{value:"Bird Variation",id:"bird-variation",level:3},{value:"Creating Custom Agents",id:"creating-custom-agents",level:2},{value:"Minimal Custom Agent",id:"minimal-custom-agent",level:3},{value:"Custom Swarm Controller",id:"custom-swarm-controller",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Performance",id:"performance",level:3},{value:"Visual Quality",id:"visual-quality",level:3},{value:"Integration",id:"integration",level:3},{value:"See Also",id:"see-also",level:2}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"swarm-integration",children:"Swarm Integration"})}),"\n",(0,i.jsx)(n.p,{children:"AirPath includes a swarm system for controlling multiple agents (birds, drones, etc.) that follow calculated paths. This page explains how to set up and customize swarm behavior."}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(n.p,{children:"The swarm system consists of:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"SwarmConfiguration"})," \u2014 ScriptableObject defining swarm behavior"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"DemoAirAgentConfiguration"})," \u2014 ScriptableObject for individual agent settings"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"SwarmDemoController"})," \u2014 Manages spawning and coordinates agents"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"DemoAirAgent"})," \u2014 Individual agent with path following and smoothing"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"architecture",children:"Architecture"}),"\n",(0,i.jsx)("img",{src:r(4600).A,alt:"How AirPath Works - Architecture Overview",width:"700"}),"\n",(0,i.jsxs)(n.p,{children:["The key integration point is ",(0,i.jsx)(n.code,{children:"SetSwarmPositionCallback()"})," \u2014 this allows PathfindingManager to query the swarm's average position for pathfinding calculations without tight coupling."]}),"\n",(0,i.jsx)(n.h2,{id:"quick-setup",children:"Quick Setup"}),"\n",(0,i.jsx)(n.h3,{id:"step-1-create-configuration-assets",children:"Step 1: Create Configuration Assets"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"SwarmConfiguration:"})}),"\n",(0,i.jsx)(n.p,{children:"Right-click in Project \u2192 Create \u2192 Pathfinding \u2192 Configurations \u2192 Swarm Configuration"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Setting"}),(0,i.jsx)(n.th,{children:"Default"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Number Of Agents"}),(0,i.jsx)(n.td,{children:"5"}),(0,i.jsx)(n.td,{children:"How many agents to spawn"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Spawn Radius"}),(0,i.jsx)(n.td,{children:"5"}),(0,i.jsx)(n.td,{children:"Radius around spawn point"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Agent Height Offset"}),(0,i.jsx)(n.td,{children:"10"}),(0,i.jsx)(n.td,{children:"Height above terrain"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Path Follow Radius"}),(0,i.jsx)(n.td,{children:"3"}),(0,i.jsx)(n.td,{children:"How closely agents follow the path"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Height Variation"}),(0,i.jsx)(n.td,{children:"2"}),(0,i.jsx)(n.td,{children:"Vertical spread between agents"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Stagger Delay"}),(0,i.jsx)(n.td,{children:"0.5"}),(0,i.jsx)(n.td,{children:"Max delay between agent starts"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Maintain Formation"}),(0,i.jsx)(n.td,{children:"true"}),(0,i.jsx)(n.td,{children:"Keep relative positions"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"DemoAirAgentConfiguration:"})}),"\n",(0,i.jsx)(n.p,{children:"Right-click in Project \u2192 Create \u2192 Pathfinding \u2192 Configurations \u2192 Bird Agent Configuration"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Setting"}),(0,i.jsx)(n.th,{children:"Default"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Bird Prefab"}),(0,i.jsx)(n.td,{children:"\u2014"}),(0,i.jsx)(n.td,{children:"Prefab with DemoAirAgent component"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Auto Spawn On First Path"}),(0,i.jsx)(n.td,{children:"true"}),(0,i.jsx)(n.td,{children:"Spawn agents when first path arrives"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Move Speed"}),(0,i.jsx)(n.td,{children:"10"}),(0,i.jsx)(n.td,{children:"Agent movement speed"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Rotation Speed"}),(0,i.jsx)(n.td,{children:"5"}),(0,i.jsx)(n.td,{children:"How fast agents turn"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Enable Path Smoothing"}),(0,i.jsx)(n.td,{children:"true"}),(0,i.jsx)(n.td,{children:"Smooth corners with Bezier curves"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"step-2-create-agent-prefab",children:"Step 2: Create Agent Prefab"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Create a GameObject with your visual (mesh, particle system, etc.)"}),"\n",(0,i.jsxs)(n.li,{children:["Add the ",(0,i.jsx)(n.code,{children:"DemoAirAgent"})," component"]}),"\n",(0,i.jsx)(n.li,{children:"Save as prefab"}),"\n",(0,i.jsxs)(n.li,{children:["Assign to DemoAirAgentConfiguration's ",(0,i.jsx)(n.strong,{children:"Bird Prefab"})," field"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"step-3-add-swarmdemocontroller",children:"Step 3: Add SwarmDemoController"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:'Create empty GameObject named "SwarmController"'}),"\n",(0,i.jsxs)(n.li,{children:["Add ",(0,i.jsx)(n.code,{children:"SwarmDemoController"})," component"]}),"\n",(0,i.jsx)(n.li,{children:"Assign both configuration assets"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"step-4-connect-to-pathfindingmanager",children:"Step 4: Connect to PathfindingManager"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"SwarmDemoController"})," automatically registers with ",(0,i.jsx)(n.code,{children:"PathfindingManager"})," on Start:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"// This happens automatically in SwarmDemoController.Start()\r\n_pathfindingManager.SetSwarmPositionCallback(GetAverageBirdPositionCallback);\n"})}),"\n",(0,i.jsxs)(n.p,{children:["When using ",(0,i.jsx)(n.strong,{children:"TargetFollow"})," mode, PathfindingManager calls this callback to get the swarm's current position as the path start point."]}),"\n",(0,i.jsx)(n.h2,{id:"swarmconfiguration-reference",children:"SwarmConfiguration Reference"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'[CreateAssetMenu(menuName = "Pathfinding/Configurations/Swarm Configuration")]\r\npublic class SwarmConfiguration : ConfigurationBase\n'})}),"\n",(0,i.jsx)(n.h3,{id:"swarm-settings",children:"Swarm Settings"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Property"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Range"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"NumberOfAgents"}),(0,i.jsx)(n.td,{children:"int"}),(0,i.jsx)(n.td,{children:"1-50"}),(0,i.jsx)(n.td,{children:"Total agents in swarm"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"SpawnRadius"}),(0,i.jsx)(n.td,{children:"float"}),(0,i.jsx)(n.td,{children:"0-20"}),(0,i.jsx)(n.td,{children:"Circular spawn area radius"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"AgentHeightOffset"}),(0,i.jsx)(n.td,{children:"float"}),(0,i.jsx)(n.td,{children:"0-50"}),(0,i.jsx)(n.td,{children:"Base height above spawn point"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"swarm-behavior",children:"Swarm Behavior"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Property"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Range"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"PathFollowRadius"}),(0,i.jsx)(n.td,{children:"float"}),(0,i.jsx)(n.td,{children:"0-10"}),(0,i.jsx)(n.td,{children:"How far agents can deviate from path"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"HeightVariation"}),(0,i.jsx)(n.td,{children:"float"}),(0,i.jsx)(n.td,{children:"0-10"}),(0,i.jsx)(n.td,{children:"Random height offset per agent"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"StaggerDelay"}),(0,i.jsx)(n.td,{children:"float"}),(0,i.jsx)(n.td,{children:"0-2"}),(0,i.jsx)(n.td,{children:"Maximum start delay for natural movement"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"MaintainFormation"}),(0,i.jsx)(n.td,{children:"bool"}),(0,i.jsx)(n.td,{children:"\u2014"}),(0,i.jsx)(n.td,{children:"Keep relative positions during flight"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"movement-settings",children:"Movement Settings"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Property"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Range"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"DefaultMoveSpeed"}),(0,i.jsx)(n.td,{children:"float"}),(0,i.jsx)(n.td,{children:"1-50"}),(0,i.jsx)(n.td,{children:"Base movement speed"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"DefaultRotationSpeed"}),(0,i.jsx)(n.td,{children:"float"}),(0,i.jsx)(n.td,{children:"1-20"}),(0,i.jsx)(n.td,{children:"Base rotation speed"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"ReachThreshold"}),(0,i.jsx)(n.td,{children:"float"}),(0,i.jsx)(n.td,{children:"0.5-5"}),(0,i.jsx)(n.td,{children:"Distance to consider waypoint reached"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"demoairagent-reference",children:"DemoAirAgent Reference"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"DemoAirAgent"})," component handles individual agent movement with path smoothing."]}),"\n",(0,i.jsx)(n.h3,{id:"inspector-settings",children:"Inspector Settings"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Movement:"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Setting"}),(0,i.jsx)(n.th,{children:"Default"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Move Speed"}),(0,i.jsx)(n.td,{children:"10"}),(0,i.jsx)(n.td,{children:"Units per second"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Rotation Speed"}),(0,i.jsx)(n.td,{children:"5"}),(0,i.jsx)(n.td,{children:"Rotation interpolation speed"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Reach Threshold"}),(0,i.jsx)(n.td,{children:"2"}),(0,i.jsx)(n.td,{children:"Distance to trigger next waypoint"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Path Smoothing:"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Setting"}),(0,i.jsx)(n.th,{children:"Default"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Enable Path Smoothing"}),(0,i.jsx)(n.td,{children:"true"}),(0,i.jsx)(n.td,{children:"Use Bezier curves at corners"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Corner Angle Threshold"}),(0,i.jsx)(n.td,{children:"45\xb0"}),(0,i.jsx)(n.td,{children:"Minimum angle to trigger smoothing"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Min Turn Radius"}),(0,i.jsx)(n.td,{children:"3"}),(0,i.jsx)(n.td,{children:"Tightest turn radius"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Max Turn Radius"}),(0,i.jsx)(n.td,{children:"10"}),(0,i.jsx)(n.td,{children:"Widest turn radius"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Terrain Clearance"}),(0,i.jsx)(n.td,{children:"2"}),(0,i.jsx)(n.td,{children:"Minimum height above terrain"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Preferred Clearance"}),(0,i.jsx)(n.td,{children:"5"}),(0,i.jsx)(n.td,{children:"Ideal height above terrain"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Turn Rate Limiting:"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Setting"}),(0,i.jsx)(n.th,{children:"Default"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Enable Turn Rate Limit"}),(0,i.jsx)(n.td,{children:"true"}),(0,i.jsx)(n.td,{children:"Prevent unrealistic instant turns"})]})})]}),"\n",(0,i.jsx)(n.h3,{id:"key-methods",children:"Key Methods"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"// Initialize swarm behavior with offsets\r\nvoid InitializeSwarmBehavior(float offsetRadius, float heightVariation)\r\n\r\n// Assign a path to follow\r\nvoid SetPath(List<Vector3> worldPath, bool teleportToStart = true)\r\n\r\n// Control movement\r\nvoid StopMovement()\r\nvoid PauseMovement()\r\nvoid ResumeMovement()\r\n\r\n// Current position (read-only)\r\nVector3 CurrentPosition { get; }\n"})}),"\n",(0,i.jsx)(n.h2,{id:"swarmdemocontroller-reference",children:"SwarmDemoController Reference"}),"\n",(0,i.jsx)(n.p,{children:"The controller manages the swarm lifecycle and coordinates with PathfindingManager."}),"\n",(0,i.jsx)(n.h3,{id:"inspector-settings-1",children:"Inspector Settings"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Setting"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Swarm Config"}),(0,i.jsx)(n.td,{children:"Reference to SwarmConfiguration asset"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Demo Air Agent Config"}),(0,i.jsx)(n.td,{children:"Reference to DemoAirAgentConfiguration asset"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"properties",children:"Properties"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"// Current average position of all agents\r\nVector3 AverageBirdPosition { get; }\r\n\r\n// Whether configurations are valid\r\nbool IsConfigured { get; }\r\n\r\n// Number of active agents\r\nint BirdCount { get; }\n"})}),"\n",(0,i.jsx)(n.h3,{id:"methods",children:"Methods"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"// Destroy all agents and reset state\r\nvoid ResetSwarm()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"automatic-behavior",children:"Automatic Behavior"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"On Start:"})," Validates configuration, registers callback with PathfindingManager"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"On PathCalculatedEvent:"})," Spawns agents (if first path) and assigns path to all agents"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"On Update:"})," Calculates average position, publishes SwarmUpdateEvent every 30 frames"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"events",children:"Events"}),"\n",(0,i.jsx)(n.h3,{id:"swarmupdateevent",children:"SwarmUpdateEvent"}),"\n",(0,i.jsx)(n.p,{children:"Published by SwarmDemoController at key moments:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'this.Subscribe<SwarmUpdateEvent>(evt =>\r\n{\r\n    switch (evt.Type)\r\n    {\r\n        case SwarmUpdateEvent.UpdateType.BirdsSpawned:\r\n            Debug.Log($"Spawned {evt.AgentCount} agents at {evt.Position}");\r\n            break;\r\n            \r\n        case SwarmUpdateEvent.UpdateType.BirdsStartedPath:\r\n            Debug.Log($"Agents started following path with {evt.Path.Count} waypoints");\r\n            break;\r\n            \r\n        case SwarmUpdateEvent.UpdateType.SwarmPositionUpdated:\r\n            Debug.Log($"Swarm center: {evt.Position}");\r\n            break;\r\n    }\r\n});\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Update Types:"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"When Published"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"BirdsSpawned"}),(0,i.jsx)(n.td,{children:"After agents are instantiated"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"BirdsStartedPath"}),(0,i.jsx)(n.td,{children:"When path is assigned to agents"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"BirdReachedTarget"}),(0,i.jsx)(n.td,{children:"When an agent completes its path"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"AllBirdsReachedTarget"}),(0,i.jsx)(n.td,{children:"When all agents complete paths"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"SwarmPositionUpdated"}),(0,i.jsx)(n.td,{children:"Every 30 frames with current position"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"path-smoothing",children:"Path Smoothing"}),"\n",(0,i.jsx)(n.p,{children:"DemoAirAgent includes sophisticated path smoothing for natural flight paths."}),"\n",(0,i.jsx)(n.h3,{id:"how-it-works",children:"How It Works"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Raw path from A* has sharp corners"}),"\n",(0,i.jsx)(n.li,{children:"PathSmoother detects corners above threshold angle"}),"\n",(0,i.jsx)(n.li,{children:"Bezier curves replace sharp turns"}),"\n",(0,i.jsx)(n.li,{children:"Speed modifiers slow agents through turns"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"configuration",children:"Configuration"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"var smoothingConfig = new PathSmoother.SmoothingConfig {\r\n    CornerAngleThreshold = 45f,   // Degrees\r\n    MinTurnRadius = 3f,\r\n    MaxTurnRadius = 10f,\r\n    BezierSegments = 5,           // Curve resolution\r\n    TerrainClearance = 2f,\r\n    PreferredClearance = 5f,\r\n    TurnSpeedMultiplier = 0.7f    // Slow down in turns\r\n};\n"})}),"\n",(0,i.jsx)(n.h3,{id:"bird-variation",children:"Bird Variation"}),"\n",(0,i.jsx)(n.p,{children:"Each agent gets random variation for natural flocking:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"var variation = new PathSmoother.BirdVariation {\r\n    speedMultiplier = Random.Range(0.9f, 1.1f),\r\n    turnRadiusMultiplier = Random.Range(0.8f, 1.2f),\r\n    heightPreference = Random.Range(-2f, 2f),\r\n    reactionDelay = Random.Range(0f, 0.3f)\r\n};\n"})}),"\n",(0,i.jsx)(n.h2,{id:"creating-custom-agents",children:"Creating Custom Agents"}),"\n",(0,i.jsx)(n.p,{children:"You can create your own agent types based on DemoAirAgent."}),"\n",(0,i.jsx)(n.h3,{id:"minimal-custom-agent",children:"Minimal Custom Agent"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'using System.Collections.Generic;\r\nusing UnityEngine;\r\n\r\npublic class SimpleAgent : MonoBehaviour\r\n{\r\n    [SerializeField] private float moveSpeed = 10f;\r\n    [SerializeField] private float reachThreshold = 2f;\r\n    \r\n    private List<Vector3> _path;\r\n    private int _currentIndex;\r\n    private bool _isMoving;\r\n    \r\n    public Vector3 CurrentPosition => transform.position;\r\n    \r\n    public void SetPath(List<Vector3> path, bool teleportToStart = true)\r\n    {\r\n        _path = new List<Vector3>(path);\r\n        _currentIndex = 0;\r\n        _isMoving = true;\r\n        \r\n        if (teleportToStart && _path.Count > 0)\r\n        {\r\n            transform.position = _path[0];\r\n        }\r\n    }\r\n    \r\n    private void Update()\r\n    {\r\n        if (!_isMoving || _path == null || _currentIndex >= _path.Count)\r\n            return;\r\n        \r\n        var target = _path[_currentIndex];\r\n        \r\n        // Move toward target\r\n        transform.position = Vector3.MoveTowards(\r\n            transform.position, \r\n            target, \r\n            moveSpeed * Time.deltaTime\r\n        );\r\n        \r\n        // Rotate toward target\r\n        var direction = (target - transform.position).normalized;\r\n        if (direction != Vector3.zero)\r\n        {\r\n            transform.rotation = Quaternion.Slerp(\r\n                transform.rotation,\r\n                Quaternion.LookRotation(direction),\r\n                5f * Time.deltaTime\r\n            );\r\n        }\r\n        \r\n        // Check if reached waypoint\r\n        if (Vector3.Distance(transform.position, target) < reachThreshold)\r\n        {\r\n            _currentIndex++;\r\n            \r\n            if (_currentIndex >= _path.Count)\r\n            {\r\n                _isMoving = false;\r\n                Debug.Log($"{name} completed path");\r\n            }\r\n        }\r\n    }\r\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"custom-swarm-controller",children:"Custom Swarm Controller"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"public class CustomSwarmController : MonoBehaviour\r\n{\r\n    [SerializeField] private GameObject agentPrefab;\r\n    [SerializeField] private int agentCount = 10;\r\n    [SerializeField] private float spawnRadius = 5f;\r\n    \r\n    private List<SimpleAgent> _agents = new();\r\n    private PathfindingManager _pathfindingManager;\r\n    \r\n    private void Start()\r\n    {\r\n        _pathfindingManager = FindFirstObjectByType<PathfindingManager>();\r\n        _pathfindingManager?.SetSwarmPositionCallback(GetAveragePosition);\r\n        \r\n        this.Subscribe<PathCalculatedEvent>(OnPathCalculated);\r\n    }\r\n    \r\n    private Vector3 GetAveragePosition()\r\n    {\r\n        if (_agents.Count == 0) return transform.position;\r\n        \r\n        var sum = Vector3.zero;\r\n        foreach (var agent in _agents)\r\n        {\r\n            sum += agent.CurrentPosition;\r\n        }\r\n        return sum / _agents.Count;\r\n    }\r\n    \r\n    private void OnPathCalculated(PathCalculatedEvent evt)\r\n    {\r\n        if (!evt.Success) return;\r\n        \r\n        // Spawn agents if needed\r\n        if (_agents.Count == 0)\r\n        {\r\n            SpawnAgents();\r\n        }\r\n        \r\n        // Assign path to all agents\r\n        foreach (var agent in _agents)\r\n        {\r\n            agent.SetPath(evt.WorldPath);\r\n        }\r\n    }\r\n    \r\n    private void SpawnAgents()\r\n    {\r\n        for (int i = 0; i < agentCount; i++)\r\n        {\r\n            var offset = Random.insideUnitSphere * spawnRadius;\r\n            offset.y = Mathf.Abs(offset.y); // Keep above ground\r\n            \r\n            var go = Instantiate(agentPrefab, transform.position + offset, Quaternion.identity);\r\n            var agent = go.GetComponent<SimpleAgent>();\r\n            \r\n            if (agent != null)\r\n            {\r\n                _agents.Add(agent);\r\n            }\r\n        }\r\n    }\r\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,i.jsx)(n.h3,{id:"performance",children:"Performance"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Keep agent count reasonable (under 50 for most cases)"}),"\n",(0,i.jsx)(n.li,{children:"Use object pooling for frequently spawned/destroyed agents"}),"\n",(0,i.jsx)(n.li,{children:"Disable path smoothing if not needed"}),"\n",(0,i.jsx)(n.li,{children:"Increase stagger delay to spread out path assignments"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"visual-quality",children:"Visual Quality"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Enable path smoothing for natural flight paths"}),"\n",(0,i.jsx)(n.li,{children:"Use height variation for depth in the swarm"}),"\n",(0,i.jsx)(n.li,{children:"Add slight speed variation for organic movement"}),"\n",(0,i.jsx)(n.li,{children:"Consider adding bobbing/banking animations"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"integration",children:"Integration"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Always register swarm callback before paths are calculated"}),"\n",(0,i.jsx)(n.li,{children:"Handle agent destruction gracefully (null checks)"}),"\n",(0,i.jsx)(n.li,{children:"Use events for loose coupling between systems"}),"\n",(0,i.jsx)(n.li,{children:"Reset swarm state on scene transitions"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"see-also",children:"See Also"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"../setup-guide/pathfinding-manager",children:"Pathfinding Manager"})," \u2014 SetSwarmPositionCallback"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"../api-reference/events",children:"Events"})," \u2014 SwarmUpdateEvent details"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"./pathfinding-modes",children:"Pathfinding Modes"})," \u2014 TargetFollow mode for swarm tracking"]}),"\n"]})]})}function c(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>d});var t=r(6540);const i={},s=t.createContext(i);function a(e){const n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);